mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
?map_if
plays_over_time))
genesis_owusu_top_songs <- songs_2021 %>%
filter(artist == "Genesis Owusu") %>%
mutate(song_title = map_if(song_title,
~== "Waiting On Ya",
return("Waiting On' Ya"))) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO_top_songs <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO_top_songs <- GO_top_songs %>%
mutate(song_title = map_if(GO_top_songs$song_title,
~== "Waiting On Ya",
return("Waiting On' Ya"))) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO_top_songs
GO_top_songs$song_title
GO_top_songs <- GO_top_songs %>%
mutate(song_title = map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function (return("Waiting On' Ya"))))
function (return("Waiting On' Ya")))
GO_top_songs <- GO_top_songs %>%
mutate(song_title = map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}))
GO_top_songs <- GO_top_songs %>%
mutate(song_title = map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO_top_songs
map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})
map_if_chr(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})
map_if_char(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})
map_char_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})
?map_char
?map_chr
map_chr_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})
?map_if_chr
modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})
modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})[1,]
modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})[1]
modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")})[[1]]
flatten(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}))
imap(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~[[i]])
imap(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.[[i]])
imap(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.[[.y]])
imap(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.[.y])
imap(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.[.y])
imap(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.)
imap(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.x)
imap(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.x[1])
imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.x[1])
GO_top_songs <- GO_top_songs %>%
mutate(song_title = imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waiting On Ya")},
function() {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(genesis_owusu_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO_top_songs <- GO_top_songs %>%
mutate(song_title = imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function() {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO_top_songs <- GO_top_songs %>%
mutate(song_title = imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function() {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function() {return("Waiting On' Ya")}), ~.x[1])
map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function() {return("Waiting On' Ya")})
map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")})
GO_top_songs <- GO_top_songs %>%
mutate(song_title = imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO_top_songs <- GO_top_songs %>%
mutate(song_title = imap_chr(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")})
modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")})
GO_top_songs <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO <- GO_top_songs %>%
mutate(song_title = imap_chr(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waiting On' Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(modify_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
GO <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO_top_songs
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1]))
imap_chr(map_if(GO_top_songs$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])
GO <- songs_2021 %>%
filter(artist == "Genesis Owusu")
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(map_if(GO$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 10) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(map_if(GO$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 6) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
ggplot(GO_top_songs) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
start_end <- GO_top_songs %>%
mutate(max = max(played_time),
min = min(played_time)) %>%
group_by(song_title) %>%
summarise(max = mean(max),
min = mean(min))
start_end
GO_top_songs
start_end <- GO_top_songs %>%
mutate(max = max(played_time),
min = min(played_time)) %>%
group_by(song_title) %>%
summarise(max = mean(max),
min = mean(min),
rank = mean(rank),
artist = "Genesis Owusu")
start_end
start_end <- GO_top_songs %>%
mutate(max = max(played_time),
min = min(played_time)) %>%
group_by(song_title) %>%
summarise(max = mean(max),
min = mean(min),
rank = mean(rank),
artist = "Genesis Owusu") %>%
pivot_longer(c(max,min), names_to = "plays_over_time", values_to = "played_time")
start_end
start_end <- GO_top_songs %>%
mutate(max = max(played_time),
min = min(played_time)) %>%
group_by(song_title) %>%
summarise(max = mean(max),
min = mean(min),
rank = mean(rank),
total_plays = mean(total_plays),
artist = "Genesis Owusu") %>%
pivot_longer(c(max,min), names_to = "plays_over_time", values_to = "played_time") %>%
mutate(plays_over_time = total_plays*(plays_over_time == "max"))
start_end
GO_top_songs
ggplot(bind_rows(GO_top_songs, start_end)) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(map_if(GO$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 8) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
start_end <- GO_top_songs %>%
mutate(max = max(played_time),
min = min(played_time)) %>%
group_by(song_title) %>%
summarise(max = mean(max),
min = mean(min),
rank = mean(rank),
total_plays = mean(total_plays),
artist = "Genesis Owusu") %>%
pivot_longer(c(max,min), names_to = "plays_over_time", values_to = "played_time") %>%
mutate(plays_over_time = total_plays*(plays_over_time == "max"))
ggplot(bind_rows(GO_top_songs, start_end)) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
GO_top_songs <- GO %>%
mutate(song_title = imap_chr(map_if(GO$song_title,
function(x) {return(x == "Waitin On Ya")},
function(x) {return("Waitin' On Ya")}), ~.x[1])) %>%
group_by(song_title) %>%
mutate(i = 1,
plays_over_time = cumsum(i),
total_plays = sum(i)) %>%
ungroup() %>%
mutate(rank = dense_rank(desc(total_plays))) %>%
select(!i) %>%
filter(rank <= 3) %>%
bind_rows() %>%
mutate(song_title = fct_reorder2(song_title,
played_time,
plays_over_time))
start_end <- GO_top_songs %>%
mutate(max = max(played_time),
min = min(played_time)) %>%
group_by(song_title) %>%
summarise(max = mean(max),
min = mean(min),
rank = mean(rank),
total_plays = mean(total_plays),
artist = "Genesis Owusu") %>%
pivot_longer(c(max,min), names_to = "plays_over_time", values_to = "played_time") %>%
mutate(plays_over_time = total_plays*(plays_over_time == "max"))
ggplot(bind_rows(GO_top_songs, start_end)) +
geom_line(mapping = aes(x = played_time,
y = plays_over_time,
color = song_title))
